<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description"
        content="Aprenda inglÃªs de forma interativa - VocabulÃ¡rio infinito, Listening, PronÃºncia e Frases do dia a dia">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="English Master">
    <meta name="mobile-web-app-capable" content="yes">

    <title>English Master - Aprenda InglÃªs do BÃ¡sico ao AvanÃ§ado</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon-180.png">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">

    <!-- Emma Chat Interface Styles -->
    <style>
        /* Emma Intro Card */
        .emma-intro-card {
            text-align: center;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(59, 130, 246, 0.1));
            border-radius: 24px;
            margin-bottom: 2rem;
        }

        .emma-large-avatar {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #8b5cf6;
            margin-bottom: 1rem;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .emma-intro-card h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .emma-intro-card p {
            color: #94a3b8;
            margin-bottom: 1rem;
        }

        .emma-badges {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .badge {
            background: rgba(139, 92, 246, 0.2);
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            color: #c4b5fd;
        }

        /* Minimal Level Selection */
        .level-select-minimal,
        .topics-minimal {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .level-select-minimal p,
        .topics-minimal p {
            color: #94a3b8;
            margin-bottom: 0.75rem;
        }

        .level-pills,
        .topic-pills {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .pill {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 0.6rem 1.2rem;
            border-radius: 25px;
            color: #e2e8f0;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .pill:hover,
        .pill.active {
            background: linear-gradient(135deg, #8b5cf6, #6366f1);
            border-color: transparent;
            transform: scale(1.05);
        }

        .topic-pills .pill {
            background: rgba(139, 92, 246, 0.1);
        }

        /* Emma Chat Interface */
        .emma-chat-interface {
            display: flex;
            flex-direction: column;
            height: calc(100vh - 200px);
            min-height: 500px;
            position: relative;
        }

        .emma-main-view {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .emma-avatar-container {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .emma-speaking-avatar {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #8b5cf6;
            transition: all 0.3s;
        }

        .emma-speaking-avatar.speaking {
            animation: speakPulse 0.5s ease-in-out infinite;
            border-color: #22c55e;
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.4);
        }

        @keyframes speakPulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.03);
            }
        }

        .speaking-indicator {
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 4px;
            background: rgba(0, 0, 0, 0.6);
            padding: 8px 16px;
            border-radius: 20px;
        }

        .speaking-indicator span {
            width: 8px;
            height: 8px;
            background: #22c55e;
            border-radius: 50%;
            animation: bounce 1s infinite;
        }

        .speaking-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .speaking-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-8px);
            }
        }

        /* Live Subtitle */
        .live-subtitle {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            border-radius: 16px;
            max-width: 90%;
            text-align: center;
        }

        .live-subtitle p {
            color: #fff;
            font-size: 1.1rem;
            line-height: 1.6;
            margin: 0;
        }

        /* Correction Popup */
        .correction-popup {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #ff6b6b, #ee5a5a);
            padding: 1rem 1.5rem;
            border-radius: 16px;
            display: flex;
            align-items: center;
            gap: 1rem;
            z-index: 100;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        .correction-badge {
            font-size: 1.5rem;
        }

        .correction-text {
            color: #fff;
            font-size: 0.95rem;
        }

        /* Input Area */
        .emma-input-area {
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 24px;
            margin: 1rem;
        }

        .input-row {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        .voice-circle,
        .send-circle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .voice-circle {
            background: linear-gradient(135deg, #8b5cf6, #6366f1);
        }

        .voice-circle:hover {
            transform: scale(1.1);
        }

        .voice-circle.recording {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            animation: recordPulse 1s infinite;
        }

        @keyframes recordPulse {

            0%,
            100% {
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4);
            }

            50% {
                box-shadow: 0 0 0 15px rgba(239, 68, 68, 0);
            }
        }

        .send-circle {
            background: linear-gradient(135deg, #22c55e, #16a34a);
        }

        .input-row input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 0.9rem 1.2rem;
            color: #fff;
            font-size: 1rem;
        }

        .input-row input::placeholder {
            color: #64748b;
        }

        /* History Toggle */
        .history-toggle {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem;
            color: #94a3b8;
            cursor: pointer;
            transition: color 0.3s;
        }

        .history-toggle:hover {
            color: #fff;
        }

        .history-panel {
            max-height: 200px;
            overflow-y: auto;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 16px;
            margin: 0 1rem 1rem;
        }

        .history-messages {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .history-msg {
            padding: 0.5rem 1rem;
            border-radius: 12px;
            font-size: 0.9rem;
        }

        .history-msg.user {
            background: rgba(139, 92, 246, 0.2);
            color: #c4b5fd;
            align-self: flex-end;
        }

        .history-msg.ai {
            background: rgba(255, 255, 255, 0.1);
            color: #e2e8f0;
        }

        /* Float Buttons */
        .settings-float,
        .end-float {
            position: absolute;
            top: 1rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s;
        }

        .settings-float {
            right: 4rem;
            background: rgba(255, 255, 255, 0.1);
        }

        .end-float {
            right: 1rem;
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .settings-float:hover,
        .end-float:hover {
            transform: scale(1.1);
        }
    </style>
</head>

<body>
    <div class="particles" id="particles"></div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-brand">
            <span class="logo">ğŸ‡ºğŸ‡¸</span>
            <span class="brand-text">English<span class="highlight">Master</span></span>
        </div>
        <div class="nav-stats">
            <div class="stat-item">
                <span class="stat-icon">ğŸ”¥</span>
                <span class="stat-value" id="streak">0</span>
                <span class="stat-label">dias</span>
            </div>
            <div class="stat-item">
                <span class="stat-icon">â­</span>
                <span class="stat-value" id="totalWords">0</span>
                <span class="stat-label">palavras</span>
            </div>
            <div class="stat-item clickable" onclick="showSection('assessment')"
                title="Clique para fazer o teste de nÃ­vel">
                <span class="stat-icon">ğŸ†</span>
                <span class="stat-value" id="currentLevel">A1 BÃ¡sico</span>
            </div>
        </div>
    </nav>

    <main class="container">
        <!-- Hero Section -->
        <section class="hero" id="heroSection">
            <div class="hero-content">
                <div class="daily-tip" id="dailyTip">
                    <span class="tip-icon">ğŸ’¡</span>
                    <span class="tip-text">Dica do dia aparecerÃ¡ aqui</span>
                </div>
                <h1 class="hero-title">
                    Aprenda InglÃªs de Forma
                    <span class="gradient-text">Inteligente</span>
                </h1>
                <p class="hero-subtitle">
                    VocabulÃ¡rio infinito, prÃ¡tica de listening e fala. Do bÃ¡sico ao avanÃ§ado.
                </p>
                <div class="hero-buttons">
                    <button class="btn btn-primary btn-lg" onclick="showSection('vocabulary')">
                        <span>ğŸ“š</span> VocabulÃ¡rio
                    </button>
                    <button class="btn btn-secondary btn-lg" onclick="showSection('phrases')">
                        <span>ğŸ’¬</span> Frases
                    </button>
                    <button class="btn btn-accent btn-lg" onclick="showSection('practice')">
                        <span>ğŸ¯</span> Praticar
                    </button>
                </div>
                <div class="hero-buttons-secondary">
                    <button class="btn btn-outline" onclick="showSection('assessment')">
                        <span>ğŸ“Š</span> Avaliar NÃ­vel
                    </button>
                    <button class="btn btn-outline" onclick="showSection('grammar')">
                        <span>ğŸ“–</span> GramÃ¡tica
                    </button>
                    <button class="btn btn-outline" onclick="showSection('verbs')">
                        <span>ğŸ“</span> Verbos Irregulares
                    </button>
                    <button class="btn btn-outline" onclick="showSection('infinite')">
                        <span>â™¾ï¸</span> Modo Infinito
                    </button>
                    <button class="btn btn-primary glow-btn" onclick="openAIChat()">
                        <span>ğŸ¤–</span> Conversar com IA
                    </button>
                    <button class="btn btn-outline share-btn" onclick="ShareApp.shareApp()">
                        <span>ğŸ“¤</span> Compartilhar
                    </button>
                </div>
            </div>
            <div class="hero-cards">
                <div class="floating-card card-1">
                    <span class="card-emoji">ğŸ§</span>
                    <span class="card-text">Listening</span>
                </div>
                <div class="floating-card card-2">
                    <span class="card-emoji">ğŸ¤</span>
                    <span class="card-text">Speaking</span>
                </div>
                <div class="floating-card card-3">
                    <span class="card-emoji">ğŸ“–</span>
                    <span class="card-text">Reading</span>
                </div>
            </div>
        </section>

        <!-- Progress Dashboard (New!) -->
        <section class="progress-dashboard" id="progressDashboard">
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="dashboard-icon">ğŸ“ˆ</div>
                    <div class="dashboard-info">
                        <span class="dashboard-value" id="wordsToday">0</span>
                        <span class="dashboard-label">Palavras Hoje</span>
                    </div>
                </div>
                <div class="dashboard-card">
                    <div class="dashboard-icon">ğŸ¯</div>
                    <div class="dashboard-info">
                        <span class="dashboard-value" id="accuracy">0%</span>
                        <span class="dashboard-label">PrecisÃ£o</span>
                    </div>
                </div>
                <div class="dashboard-card">
                    <div class="dashboard-icon">â±ï¸</div>
                    <div class="dashboard-info">
                        <span class="dashboard-value" id="studyTime">0m</span>
                        <span class="dashboard-label">Tempo de Estudo</span>
                    </div>
                </div>
                <div class="dashboard-card">
                    <div class="dashboard-icon">ğŸ…</div>
                    <div class="dashboard-info">
                        <span class="dashboard-value" id="achievements">0</span>
                        <span class="dashboard-label">Conquistas</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Level Selection -->
        <section class="level-section hidden" id="levelSection">
            <div class="section-header">
                <button class="btn-back" onclick="goBack()">â† Voltar</button>
                <h2 class="section-title">Selecione seu NÃ­vel</h2>
            </div>
            <div class="level-cards">
                <div class="level-card" data-level="beginner" onclick="selectLevel('beginner')">
                    <div class="level-icon">ğŸŒ±</div>
                    <h3>BÃ¡sico (A1-A2)</h3>
                    <p>Palavras essenciais, cumprimentos, nÃºmeros, cores, famÃ­lia, verbos comuns</p>
                    <div class="level-progress">
                        <div class="progress-bar" id="progressBeginner"></div>
                    </div>
                    <span class="level-count" id="countBeginner">0/300</span>
                </div>
                <div class="level-card" data-level="intermediate" onclick="selectLevel('intermediate')">
                    <div class="level-icon">ğŸŒ¿</div>
                    <h3>IntermediÃ¡rio (B1-B2)</h3>
                    <p>Phrasal verbs, expressÃµes, conectores, vocabulÃ¡rio de negÃ³cios</p>
                    <div class="level-progress">
                        <div class="progress-bar" id="progressIntermediate"></div>
                    </div>
                    <span class="level-count" id="countIntermediate">0/210</span>
                </div>
                <div class="level-card" data-level="advanced" onclick="selectLevel('advanced')">
                    <div class="level-icon">ğŸŒ³</div>
                    <h3>AvanÃ§ado (C1-C2)</h3>
                    <p>ExpressÃµes formais, idioms, slang, vocabulÃ¡rio profissional</p>
                    <div class="level-progress">
                        <div class="progress-bar" id="progressAdvanced"></div>
                    </div>
                    <span class="level-count" id="countAdvanced">0/125</span>
                </div>
            </div>
        </section>

        <!-- Vocabulary Section -->
        <section class="vocabulary-section hidden" id="vocabularySection">
            <div class="section-header">
                <button class="btn-back" onclick="goBack()">â† Voltar</button>
                <h2 class="section-title">ğŸ“š VocabulÃ¡rio</h2>
                <div class="category-filter">
                    <select id="categorySelect" onchange="filterByCategory()">
                        <option value="all">Todas Categorias</option>
                    </select>
                </div>
            </div>

            <div class="flashcard-container">
                <div class="flashcard" id="flashcard" onclick="flipCard()">
                    <div class="flashcard-inner" id="flashcardInner">
                        <div class="flashcard-front">
                            <span class="word-category" id="wordCategory">Categoria</span>
                            <h2 class="word-english" id="wordEnglish">Hello</h2>
                            <p class="word-phonetic" id="wordPhonetic">/hÉ™ËˆloÊŠ/</p>
                            <button class="btn-audio" onclick="event.stopPropagation(); speakWord()">
                                ğŸ”Š Ouvir
                            </button>
                        </div>
                        <div class="flashcard-back">
                            <h2 class="word-portuguese" id="wordPortuguese">OlÃ¡</h2>
                            <p class="word-example" id="wordExample">"Hello, how are you?"</p>
                            <p class="word-example-pt" id="wordExamplePt">"OlÃ¡, como vocÃª estÃ¡?"</p>
                        </div>
                    </div>
                </div>

                <div class="flashcard-controls">
                    <button class="btn btn-danger" onclick="markWord('difficult')">ğŸ˜“ DifÃ­cil</button>
                    <button class="btn btn-warning" onclick="markWord('learning')">ğŸ¤” Aprendendo</button>
                    <button class="btn btn-success" onclick="markWord('known')">âœ… Sei</button>
                </div>

                <div class="flashcard-navigation">
                    <button class="btn-nav" onclick="previousWord()">â† Anterior</button>
                    <span class="word-counter" id="wordCounter">1/100</span>
                    <button class="btn-nav" onclick="nextWord()">PrÃ³xima â†’</button>
                </div>
            </div>
        </section>

        <!-- Phrases Section -->
        <section class="phrases-section hidden" id="phrasesSection">
            <div class="section-header">
                <button class="btn-back" onclick="goBack()">â† Voltar</button>
                <h2 class="section-title">ğŸ’¬ Frases do Dia a Dia</h2>
            </div>

            <div class="phrases-categories">
                <button class="category-btn active" data-category="greetings"
                    onclick="selectPhraseCategory('greetings')">ğŸ‘‹ Cumprimentos</button>
                <button class="category-btn" data-category="restaurant" onclick="selectPhraseCategory('restaurant')">ğŸ½ï¸
                    Restaurante</button>
                <button class="category-btn" data-category="shopping" onclick="selectPhraseCategory('shopping')">ğŸ›’
                    Compras</button>
                <button class="category-btn" data-category="travel" onclick="selectPhraseCategory('travel')">âœˆï¸
                    Viagem</button>
                <button class="category-btn" data-category="work" onclick="selectPhraseCategory('work')">ğŸ’¼
                    Trabalho</button>
                <button class="category-btn" data-category="emergency" onclick="selectPhraseCategory('emergency')">ğŸ†˜
                    EmergÃªncia</button>
                <button class="category-btn" data-category="smalltalk" onclick="selectPhraseCategory('smalltalk')">ğŸ’­
                    Conversa</button>
                <button class="category-btn" data-category="feelings" onclick="selectPhraseCategory('feelings')">â¤ï¸
                    Sentimentos</button>
                <button class="category-btn" data-category="opinions" onclick="selectPhraseCategory('opinions')">ğŸ’¡
                    OpiniÃµes</button>
                <button class="category-btn" data-category="technology" onclick="selectPhraseCategory('technology')">ğŸ“±
                    Tecnologia</button>
            </div>

            <div class="phrases-list" id="phrasesList"></div>
        </section>

        <!-- Practice Section -->
        <section class="practice-section hidden" id="practiceSection">
            <div class="section-header">
                <button class="btn-back" onclick="goBack()">â† Voltar</button>
                <h2 class="section-title">ğŸ¯ PrÃ¡tica</h2>
            </div>

            <div class="practice-modes">
                <div class="practice-card" onclick="startPractice('listening')">
                    <div class="practice-icon">ğŸ§</div>
                    <h3>Listening</h3>
                    <p>OuÃ§a e escreva</p>
                </div>
                <div class="practice-card" onclick="startPractice('speaking')">
                    <div class="practice-icon">ğŸ¤</div>
                    <h3>Speaking</h3>
                    <p>Fale e verifique</p>
                </div>
                <div class="practice-card" onclick="startPractice('quiz')">
                    <div class="practice-icon">ğŸ“</div>
                    <h3>Quiz</h3>
                    <p>Teste seu conhecimento</p>
                </div>
                <div class="practice-card" onclick="startPractice('translate')">
                    <div class="practice-icon">ğŸ”„</div>
                    <h3>TraduÃ§Ã£o</h3>
                    <p>Traduza frases</p>
                </div>
            </div>
        </section>

        <!-- Assessment Section (NEW!) -->
        <section class="assessment-section hidden" id="assessmentSection">
            <div class="section-header">
                <button class="btn-back" onclick="goBack()">â† Voltar</button>
                <h2 class="section-title">ğŸ“Š AvaliaÃ§Ã£o de NÃ­vel</h2>
            </div>

            <div class="assessment-intro" id="assessmentIntro">
                <div class="assessment-card">
                    <div class="assessment-icon">ğŸ¯</div>
                    <h3>Descubra seu NÃ­vel de InglÃªs</h3>
                    <p>Responda 50 perguntas para descobrir seu nÃ­vel atual de inglÃªs. O teste avalia vocabulÃ¡rio,
                        gramÃ¡tica e compreensÃ£o.</p>
                    <div class="level-scale">
                        <div class="level-item">A1 Iniciante</div>
                        <div class="level-item">A2 BÃ¡sico</div>
                        <div class="level-item">B1 IntermediÃ¡rio</div>
                        <div class="level-item">B2 IntermediÃ¡rio Superior</div>
                        <div class="level-item">C1 AvanÃ§ado</div>
                    </div>
                    <button class="btn btn-primary btn-lg" onclick="startAssessment()">Iniciar AvaliaÃ§Ã£o</button>
                </div>
            </div>

            <div class="assessment-quiz hidden" id="assessmentQuiz">
                <div class="assessment-progress">
                    <div class="assessment-progress-bar" id="assessmentProgressBar"></div>
                </div>
                <p class="assessment-counter" id="assessmentCounter">Pergunta 1/50</p>
                <div class="assessment-question" id="assessmentQuestion">
                    <h3 id="assessmentQuestionText">Question</h3>
                </div>
                <div class="assessment-options" id="assessmentOptions"></div>
            </div>

            <div class="assessment-result hidden" id="assessmentResult">
                <div class="result-card">
                    <div class="result-icon" id="resultIcon">ğŸ¯</div>
                    <h2 id="resultLevel">Seu NÃ­vel: B1</h2>
                    <p id="resultDescription">DescriÃ§Ã£o do nÃ­vel</p>
                    <div class="result-scores">
                        <div class="score-item">
                            <span class="score-label">PontuaÃ§Ã£o</span>
                            <span class="score-value" id="resultScore">0/50</span>
                        </div>
                        <div class="score-item">
                            <span class="score-label">Percentual</span>
                            <span class="score-value" id="resultPercent">0%</span>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="goBack()">Voltar ao Menu</button>
                    <button class="btn btn-secondary" onclick="startAssessment()">Refazer Teste</button>
                </div>
            </div>
        </section>

        <!-- Grammar Section (NEW!) -->
        <section class="grammar-section hidden" id="grammarSection">
            <div class="section-header">
                <button class="btn-back" onclick="goBack()">â† Voltar</button>
                <h2 class="section-title">ğŸ“– GramÃ¡tica</h2>
            </div>

            <div class="grammar-tabs">
                <button class="grammar-tab active" onclick="showGrammarLevel('beginner')">BÃ¡sico</button>
                <button class="grammar-tab" onclick="showGrammarLevel('intermediate')">IntermediÃ¡rio</button>
                <button class="grammar-tab" onclick="showGrammarLevel('advanced')">AvanÃ§ado</button>
            </div>

            <div class="grammar-content" id="grammarContent"></div>
        </section>

        <!-- Irregular Verbs Section (NEW!) -->
        <section class="verbs-section hidden" id="verbsSection">
            <div class="section-header">
                <button class="btn-back" onclick="goBack()">â† Voltar</button>
                <h2 class="section-title">ğŸ“ Verbos Irregulares</h2>
            </div>

            <div class="verbs-search">
                <input type="text" id="verbSearch" placeholder="Buscar verbo..." oninput="searchVerbs()">
            </div>

            <div class="verbs-table">
                <div class="verbs-header">
                    <span>Base</span>
                    <span>Past</span>
                    <span>Participle</span>
                    <span>TraduÃ§Ã£o</span>
                    <span>ğŸ”Š</span>
                </div>
            </div>
        </section>

        <!-- Infinite Mode Section (NEW!) -->
        <section class="infinite-section hidden" id="infiniteSection">
            <div class="section-header">
                <button class="btn-back" onclick="goBack()">â† Voltar</button>
                <h2 class="section-title">â™¾ï¸ Modo Infinito</h2>
            </div>

            <div class="infinite-intro">
                <p class="infinite-description">
                    ğŸŒ VocabulÃ¡rio e quiz gerados em tempo real da internet! Nunca repete e sempre traz conteÃºdo novo.
                </p>
            </div>

            <div class="infinite-modes">
                <div class="practice-card" onclick="startInfiniteVocab()">
                    <div class="practice-icon">ğŸŒ</div>
                    <h3>VocabulÃ¡rio Online</h3>
                    <p>Palavras novas da internet</p>
                </div>
                <div class="practice-card" onclick="startLocalVocab()">
                    <div class="practice-icon">ğŸ“š</div>
                    <h3>VocabulÃ¡rio Local</h3>
                    <p>3000+ palavras offline</p>
                </div>
                <div class="practice-card" onclick="startInfiniteQuiz()">
                    <div class="practice-icon">ğŸ§ </div>
                    <h3>Quiz Infinito</h3>
                    <p>Perguntas sempre novas</p>
                </div>
                <div class="practice-card" onclick="startLocalQuiz()">
                    <div class="practice-icon">ğŸ“</div>
                    <h3>Quiz RÃ¡pido</h3>
                    <p>Quiz offline instantÃ¢neo</p>
                </div>
                <div class="practice-card" onclick="startFillBlanks()">
                    <div class="practice-icon">âœï¸</div>
                    <h3>Complete a Frase</h3>
                    <p>Preencha as lacunas</p>
                </div>
                <div class="practice-card" onclick="showWordOfDay()">
                    <div class="practice-icon">ğŸ“…</div>
                    <h3>Palavra do Dia</h3>
                    <p>Aprenda diariamente</p>
                </div>
                <div class="practice-card" onclick="startSynonyms()">
                    <div class="practice-icon">ğŸ”„</div>
                    <h3>SinÃ´nimos</h3>
                    <p>Palavras similares</p>
                </div>
                <div class="practice-card" onclick="loadRandomQuote()">
                    <div class="practice-icon">ğŸ’­</div>
                    <h3>Frases Inspiradoras</h3>
                    <p>CitaÃ§Ãµes em inglÃªs</p>
                </div>
                <div class="practice-card" onclick="showShareOptions()">
                    <div class="practice-icon">ğŸ“¤</div>
                    <h3>Compartilhar</h3>
                    <p>Convide amigos!</p>
                </div>
            </div>

            <div class="infinite-content hidden" id="infiniteContent">
                <div class="loading-spinner hidden" id="loadingSpinner">
                    <div class="spinner"></div>
                    <p>Buscando conteÃºdo...</p>
                </div>
                <div id="infiniteWordCard" class="infinite-word-card hidden">
                    <span class="infinite-category" id="infiniteCategory">Word</span>
                    <h2 class="infinite-word" id="infiniteWord">Loading...</h2>
                    <p class="infinite-phonetic" id="infinitePhonetic"></p>
                    <p class="infinite-definition" id="infiniteDefinition"></p>
                    <p class="infinite-example" id="infiniteExample"></p>
                    <button class="btn btn-audio" onclick="speakInfiniteWord()">ğŸ”Š Ouvir</button>
                    <button class="btn btn-primary" onclick="nextInfiniteWord()">PrÃ³xima Palavra â†’</button>
                </div>
                <div id="localWordCard" class="infinite-word-card hidden">
                    <span class="infinite-category" id="localCategory">Word</span>
                    <h2 class="infinite-word" id="localWord">Loading...</h2>
                    <p class="infinite-phonetic" id="localPhonetic"></p>
                    <p class="infinite-definition" id="localTranslation"></p>
                    <p class="infinite-example" id="localExample"></p>
                    <button class="btn btn-audio" onclick="speakLocalWord()">ğŸ”Š Ouvir</button>
                    <button class="btn btn-primary" onclick="nextLocalWord()">PrÃ³xima Palavra â†’</button>
                </div>
                <div id="infiniteQuizCard" class="infinite-quiz-card hidden">
                    <h3 id="infiniteQuizQuestion">Question</h3>
                    <div id="infiniteQuizOptions" class="quiz-options"></div>
                    <button class="btn btn-secondary" onclick="nextInfiniteQuiz()">PrÃ³xima Pergunta â†’</button>
                </div>
                <div id="localQuizCard" class="infinite-quiz-card hidden">
                    <h3 id="localQuizQuestion">Question</h3>
                    <div id="localQuizOptions" class="quiz-options"></div>
                    <button class="btn btn-secondary" onclick="nextLocalQuiz()">PrÃ³xima Pergunta â†’</button>
                </div>
                <div id="fillBlankCard" class="infinite-word-card hidden">
                    <h3>Complete a Frase:</h3>
                    <p class="fill-sentence" id="fillSentence">Loading...</p>
                    <p class="fill-hint" id="fillHint">ğŸ’¡ Dica: ...</p>
                    <input type="text" class="fill-input" id="fillInput" placeholder="Digite a palavra...">
                    <button class="btn btn-primary" onclick="checkFillBlank()">Verificar</button>
                    <div id="fillResult" class="fill-result hidden"></div>
                    <button class="btn btn-secondary" onclick="nextFillBlank()">PrÃ³xima â†’</button>
                </div>
                <div id="wordOfDayCard" class="infinite-word-card hidden">
                    <span class="wod-date" id="wodDate">ğŸ“… Data</span>
                    <h2 class="infinite-word" id="wodWord">Word</h2>
                    <p class="infinite-definition" id="wodTranslation">Translation</p>
                    <button class="btn btn-audio" onclick="speakWOD()">ğŸ”Š Ouvir</button>
                </div>
                <div id="synonymCard" class="infinite-word-card hidden">
                    <h3>SinÃ´nimos de:</h3>
                    <h2 class="infinite-word" id="synonymWord">Word</h2>
                    <div class="synonym-list" id="synonymList"></div>
                    <h4>AntÃ´nimo:</h4>
                    <p class="antonym" id="antonymWord">Antonym</p>
                    <button class="btn btn-primary" onclick="nextSynonym()">PrÃ³xima Palavra â†’</button>
                </div>
                <div id="quoteCard" class="quote-card hidden">
                    <blockquote id="quoteText">"Quote"</blockquote>
                    <cite id="quoteAuthor">- Author</cite>
                    <button class="btn btn-audio" onclick="speakQuote()">ğŸ”Š Ouvir</button>
                    <button class="btn btn-primary" onclick="loadRandomQuote()">Nova CitaÃ§Ã£o â†’</button>
                </div>
            </div>

            <!-- Share Options Modal -->
            <div class="share-options hidden" id="shareOptions">
                <h3>ğŸ“¤ Compartilhar com Amigos</h3>
                <p>Escolha como compartilhar:</p>
                <div class="share-buttons">
                    <button class="btn btn-whatsapp" onclick="ShareApp.shareWhatsApp()">
                        <span>ğŸ’¬</span> WhatsApp
                    </button>
                    <button class="btn btn-telegram" onclick="ShareApp.shareTelegram()">
                        <span>ğŸ“¨</span> Telegram
                    </button>
                    <button class="btn btn-copy" onclick="ShareApp.copyToClipboard()">
                        <span>ğŸ“‹</span> Copiar Link
                    </button>
                </div>
                <p class="share-note">ğŸ’¡ Para seus amigos acessarem, o app precisa estar hospedado online!</p>
            </div>
        </section>

        <!-- AI Conversation Section (NEW!) -->
        <section class="conversation-section hidden" id="conversationSection">
            <div class="section-header">
                <button class="btn-back" onclick="goBack()">â† Voltar</button>
                <h2 class="section-title">ğŸ¤ Conversa com Emma</h2>
            </div>

            <!-- Level and Topic Selection -->
            <div class="conversation-setup" id="conversationSetup">
                <div class="emma-intro-card">
                    <img src="emma-avatar.png" alt="Emma" class="emma-large-avatar">
                    <h3>Emma</h3>
                    <p>Sua professora de inglÃªs</p>
                    <div class="emma-badges">
                        <span class="badge">ğŸ“ Nativa</span>
                        <span class="badge">ğŸ’¬ Paciente</span>
                        <span class="badge">ğŸ“ Corrige erros</span>
                    </div>
                </div>

                <div class="level-select-minimal">
                    <p>Selecione seu nÃ­vel:</p>
                    <div class="level-pills">
                        <button class="pill active" onclick="selectConversationLevel('beginner')" id="levelBeginner">ğŸŒ±
                            Iniciante</button>
                        <button class="pill" onclick="selectConversationLevel('intermediate')" id="levelIntermediate">ğŸŒ¿
                            IntermediÃ¡rio</button>
                        <button class="pill" onclick="selectConversationLevel('advanced')" id="levelAdvanced">ğŸŒ³
                            AvanÃ§ado</button>
                    </div>
                </div>

                <div class="topics-minimal">
                    <p>Sobre o que vamos conversar?</p>
                    <div class="topic-pills" id="topicGrid">
                        <!-- Topics loaded dynamically -->
                    </div>
                </div>
            </div>

            <!-- Clean Chat Interface -->
            <div class="emma-chat-interface hidden" id="chatContainer">
                <!-- Emma Avatar Section - Main Focus -->
                <div class="emma-main-view">
                    <div class="emma-avatar-container">
                        <img src="emma-avatar.png" alt="Emma" class="emma-speaking-avatar" id="emmaAvatar">
                        <div class="speaking-indicator hidden" id="speakingIndicator">
                            <span></span><span></span><span></span>
                        </div>
                    </div>

                    <!-- Live Subtitle - Shows current speech -->
                    <div class="live-subtitle" id="liveSubtitle">
                        <p id="subtitleText">OlÃ¡! Escolha um tema e vamos conversar! ğŸ˜Š</p>
                    </div>

                    <!-- Correction popup -->
                    <div class="correction-popup hidden" id="correctionPopup">
                        <div class="correction-badge">ğŸ“</div>
                        <div class="correction-text" id="correctionText"></div>
                    </div>
                </div>

                <!-- Minimal Input Area -->
                <div class="emma-input-area">
                    <div class="input-row">
                        <button class="voice-circle" id="voiceBtn" onclick="startVoiceInput()">
                            <span id="voiceIcon">ğŸ¤</span>
                        </button>
                        <input type="text" id="chatInput" placeholder="Type in English..."
                            onkeypress="handleChatKeyPress(event)">
                        <button class="send-circle" onclick="sendChatMessage()">â¤</button>
                    </div>
                </div>

                <!-- Expandable History Panel -->
                <div class="history-toggle" onclick="toggleHistory()">
                    <span>ğŸ“œ HistÃ³rico</span>
                    <span id="historyArrow">â–¼</span>
                </div>

                <div class="history-panel hidden" id="historyPanel">
                    <div class="history-messages" id="chatMessages">
                        <!-- Messages stored here -->
                    </div>
                </div>

                <!-- Settings Button -->
                <button class="settings-float" onclick="toggleChatSettings()">âš™ï¸</button>
                <button class="end-float" onclick="endConversation()">âœ•</button>
            </div>

            <!-- Settings Modal -->
            <div class="chat-settings hidden" id="chatSettings">
                <h4>âš™ï¸ ConfiguraÃ§Ãµes</h4>
                <label class="setting-option">
                    <input type="checkbox" id="autoSpeak" checked>
                    <span>Emma fala automaticamente</span>
                </label>
                <label class="setting-option">
                    <input type="checkbox" id="showCorrections" checked>
                    <span>Mostrar correÃ§Ãµes</span>
                </label>
                <label class="setting-option">
                    <input type="checkbox" id="slowSpeech">
                    <span>Fala mais devagar</span>
                </label>
                <button class="btn btn-primary" onclick="toggleChatSettings()">Fechar</button>
            </div>
        </section>
    </main>

    <!-- Modals -->
    <div class="modal hidden" id="listeningModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('listeningModal')">Ã—</button>
            <h2>ğŸ§ PrÃ¡tica de Listening</h2>
            <div class="listening-container">
                <p class="listening-instruction">Clique para ouvir e digite o que vocÃª entendeu:</p>
                <button class="btn-listen-large" id="listenBtn" onclick="playListening()">ğŸ”Š</button>
                <input type="text" class="listening-input" id="listeningInput" placeholder="Digite o que ouviu...">
                <button class="btn btn-primary" onclick="checkListening()">Verificar</button>
                <div class="listening-result hidden" id="listeningResult"></div>
                <button class="btn btn-secondary" onclick="nextListening()">PrÃ³ximo â†’</button>
            </div>
        </div>
    </div>

    <div class="modal hidden" id="speakingModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('speakingModal')">Ã—</button>
            <h2>ğŸ¤ PrÃ¡tica de Speaking</h2>
            <div class="speaking-container">
                <p class="speaking-instruction">Leia a frase em voz alta:</p>
                <div class="speaking-phrase" id="speakingPhrase">Hello, how are you?</div>
                <button class="btn-listen-large" onclick="speakPhrase()">ğŸ”Š Ouvir</button>
                <button class="btn-mic" id="micBtn" onclick="startRecording()">ğŸ¤</button>
                <p class="recording-status hidden" id="recordingStatus">ğŸ”´ Gravando...</p>
                <div class="speaking-result hidden" id="speakingResult"></div>
                <button class="btn btn-secondary" onclick="nextSpeaking()">PrÃ³ximo â†’</button>
            </div>
        </div>
    </div>

    <div class="modal hidden" id="quizModal">
        <div class="modal-content modal-quiz">
            <button class="modal-close" onclick="closeModal('quizModal')">Ã—</button>
            <h2>ğŸ“ Quiz de VocabulÃ¡rio</h2>
            <div class="quiz-container">
                <div class="quiz-progress">
                    <div class="quiz-progress-bar" id="quizProgressBar"></div>
                </div>
                <p class="quiz-counter" id="quizCounter">Pergunta 1/10</p>
                <div class="quiz-question" id="quizQuestion">
                    <h3 id="quizWord">Word</h3>
                    <button class="btn-audio-small" onclick="speakQuizWord()">ğŸ”Š</button>
                </div>
                <div class="quiz-options" id="quizOptions"></div>
                <div class="quiz-feedback hidden" id="quizFeedback"></div>
            </div>
        </div>
    </div>

    <div class="modal hidden" id="translateModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('translateModal')">Ã—</button>
            <h2>ğŸ”„ PrÃ¡tica de TraduÃ§Ã£o</h2>
            <div class="translate-container">
                <div class="translate-direction" id="translateDirection">
                    <button class="direction-btn active" onclick="setTranslateDirection('pt-en')">PT â†’ EN</button>
                    <button class="direction-btn" onclick="setTranslateDirection('en-pt')">EN â†’ PT</button>
                </div>
                <div class="translate-phrase" id="translatePhrase">OlÃ¡, como vocÃª estÃ¡?</div>
                <input type="text" class="translate-input" id="translateInput" placeholder="Digite a traduÃ§Ã£o...">
                <button class="btn btn-primary" onclick="checkTranslation()">Verificar</button>
                <div class="translate-result hidden" id="translateResult"></div>
                <button class="btn btn-secondary" onclick="nextTranslation()">PrÃ³ximo â†’</button>
            </div>
        </div>
    </div>

    <div class="toast-container" id="toastContainer"></div>

    <!-- Core Vocabulary -->
    <script src="vocabulary.js"></script>
    <script src="vocabulary-advanced.js"></script>

    <!-- Expanded Vocabulary (2000+ words) -->
    <script src="vocabulary-nouns.js"></script>
    <script src="vocabulary-verbs.js"></script>
    <script src="vocabulary-adj.js"></script>
    <script src="vocabulary-misc.js"></script>
    <script src="vocabulary-food-health.js"></script>
    <script src="vocabulary-business-emotions.js"></script>

    <!-- NEW: Mega Vocabulary Expansion (3000+ words total!) -->
    <script src="vocabulary-mega-1.js"></script>
    <script src="vocabulary-mega-2.js"></script>
    <script src="vocabulary-mega-3.js"></script>
    <script src="vocabulary-compiler.js"></script>

    <!-- Data & App -->
    <script src="data.js"></script>
    <script src="infinite-resources.js"></script>
    <script src="infinite-generator.js"></script>
    <script src="ai-conversation.js"></script>
    <script src="app.js"></script>

    <!-- Emma Chat System - Clean Interface with Live Subtitles -->
    <script>
        let selectedConversationLevel = 'beginner';
        let isRecording = false;

        window.initConversation = function () {
            if (typeof AIConversation !== 'undefined') {
                AIConversation.init();
                loadTopics(selectedConversationLevel);
            }
        };

        window.selectConversationLevel = function (level) {
            selectedConversationLevel = level;
            document.querySelectorAll('.pill').forEach(btn => btn.classList.remove('active'));
            const btn = document.getElementById('level' + level.charAt(0).toUpperCase() + level.slice(1));
            if (btn) btn.classList.add('active');
            loadTopics(level);
        };

        window.loadTopics = function (level) {
            const topicGrid = document.getElementById('topicGrid');
            if (!topicGrid || typeof AIConversation === 'undefined') return;
            const topics = AIConversation.getSuggestedTopics(level);
            topicGrid.innerHTML = topics.map(topic =>
                `<button class="pill" onclick="startConversationTopic('${topic.id}')">${topic.icon} ${topic.name.split(' ').slice(1).join(' ') || topic.name}</button>`
            ).join('');
        };

        window.startConversationTopic = function (topicId) {
            document.getElementById('conversationSetup').classList.add('hidden');
            document.getElementById('chatContainer').classList.remove('hidden');
            document.getElementById('chatMessages').innerHTML = '';
            showSubtitle("Let me think... ğŸ¤”");

            setTimeout(() => {
                const msg = AIConversation.startConversation(topicId, selectedConversationLevel);
                showEmmaMessage(msg);
            }, 2500 + Math.random() * 1500);
        };

        function showEmmaMessage(message) {
            setEmmaSpeaking(true);
            showSubtitle(message);
            addToHistory('ai', message);
            if (document.getElementById('autoSpeak')?.checked) {
                speakWithAnimation(message);
            } else {
                setTimeout(() => setEmmaSpeaking(false), 3000);
            }
        }

        function showSubtitle(text) {
            const el = document.getElementById('subtitleText');
            if (el) { el.style.opacity = '0'; setTimeout(() => { el.textContent = text; el.style.opacity = '1'; }, 150); }
        }

        function setEmmaSpeaking(speaking) {
            const avatar = document.getElementById('emmaAvatar');
            const indicator = document.getElementById('speakingIndicator');
            if (avatar) avatar.classList.toggle('speaking', speaking);
            if (indicator) indicator.classList.toggle('hidden', !speaking);
        }

        function speakWithAnimation(text) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const u = new SpeechSynthesisUtterance(text);
                u.lang = 'en-US';
                u.rate = document.getElementById('slowSpeech')?.checked ? 0.7 : 0.9;
                u.onstart = () => setEmmaSpeaking(true);
                u.onend = () => setEmmaSpeaking(false);
                window.speechSynthesis.speak(u);
            }
        }

        function addToHistory(role, message) {
            const el = document.getElementById('chatMessages');
            const div = document.createElement('div');
            div.className = `history-msg ${role}`;
            div.textContent = role === 'ai' ? `Emma: ${message}` : `You: ${message}`;
            el.appendChild(div);
            el.scrollTop = el.scrollHeight;
        }

        window.toggleHistory = function () {
            const panel = document.getElementById('historyPanel');
            const arrow = document.getElementById('historyArrow');
            if (panel) { panel.classList.toggle('hidden'); arrow.textContent = panel.classList.contains('hidden') ? 'â–¼' : 'â–²'; }
        };

        window.sendChatMessage = async function () {
            const input = document.getElementById('chatInput');
            const msg = input.value.trim();
            if (!msg) return;
            showSubtitle(`You: "${msg}"`);
            addToHistory('user', msg);
            input.value = '';

            setTimeout(() => showSubtitle("Thinking... ğŸ’­"), 1000);

            const result = await AIConversation.processMessage(msg);

            if (result.corrections?.length > 0) {
                const c = result.corrections[0];
                const popup = document.getElementById('correctionPopup');
                const text = document.getElementById('correctionText');
                if (popup && text) {
                    text.innerHTML = `<b>"${c.wrong}"</b> â†’ <b>"${c.correct}"</b><br><small>${c.explanation}</small>`;
                    popup.classList.remove('hidden');
                    setTimeout(() => popup.classList.add('hidden'), 5000);
                }
            }

            setTimeout(() => {
                if (result.encouragement) {
                    showSubtitle(result.encouragement);
                    setTimeout(() => showEmmaMessage(result.response), 2000);
                } else {
                    showEmmaMessage(result.response);
                }
            }, 2500 + Math.random() * 1500);
        };

        window.handleChatKeyPress = function (e) { if (e.key === 'Enter') sendChatMessage(); };

        window.startVoiceInput = function () {
            const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!SR) { alert('Use Chrome ou Edge para voz.'); return; }

            const voiceBtn = document.getElementById('voiceBtn');
            const voiceIcon = document.getElementById('voiceIcon');

            if (isRecording) { isRecording = false; voiceBtn.classList.remove('recording'); voiceIcon.textContent = 'ğŸ¤'; return; }

            const r = new SR();
            r.lang = 'en-US';
            r.continuous = false;
            r.interimResults = true;

            isRecording = true;
            voiceBtn.classList.add('recording');
            voiceIcon.textContent = 'ğŸ”´';
            showSubtitle("ğŸ¤ Listening... Speak in English!");

            try { r.start(); } catch (e) { isRecording = false; voiceBtn.classList.remove('recording'); voiceIcon.textContent = 'ğŸ¤'; return; }

            r.onresult = (e) => {
                const t = e.results[0][0].transcript;
                document.getElementById('chatInput').value = t;
                showSubtitle(`"${t}"`);
                if (e.results[0].isFinal) setTimeout(() => sendChatMessage(), 500);
            };

            r.onend = () => { isRecording = false; voiceBtn.classList.remove('recording'); voiceIcon.textContent = 'ğŸ¤'; };
            r.onerror = () => { isRecording = false; voiceBtn.classList.remove('recording'); voiceIcon.textContent = 'ğŸ¤'; };
        };

        window.toggleChatSettings = function () { document.getElementById('chatSettings')?.classList.toggle('hidden'); };

        window.endConversation = function () {
            if (typeof AIConversation !== 'undefined') AIConversation.reset();
            document.getElementById('chatContainer').classList.add('hidden');
            document.getElementById('conversationSetup').classList.remove('hidden');
            document.getElementById('chatMessages').innerHTML = '';
        };

        window.openAIChat = function () {
            ['heroSection', 'levelSection', 'vocabularySection', 'phrasesSection', 'practiceSection', 'assessmentSection', 'grammarSection', 'verbsSection', 'infiniteSection', 'progressDashboard'].forEach(s => document.getElementById(s)?.classList.add('hidden'));
            const conv = document.getElementById('conversationSection');
            if (conv) { conv.classList.remove('hidden'); conv.scrollIntoView({ behavior: 'smooth' }); }
            if (typeof AIConversation !== 'undefined') { AIConversation.init(); loadTopics(selectedConversationLevel); }
        };

        console.log('ğŸ¤ Emma Chat ready!');
    </script>
</body>

</html>
